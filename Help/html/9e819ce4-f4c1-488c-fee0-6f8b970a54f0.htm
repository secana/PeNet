<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>PeFile.GetImpHash Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="GetImpHash method" /><meta name="System.Keywords" content="PeFile.GetImpHash method" /><meta name="Microsoft.Help.F1" content="PeNet.PeFile.GetImpHash" /><meta name="Microsoft.Help.Id" content="M:PeNet.PeFile.GetImpHash" /><meta name="Description" content="Mandiant’s imphash convention requires the following: Resolving ordinals to function names when they appear. Converting both DLL names and function names to all lowercase. Removing the file extensions from imported module names." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="PeNet" /><meta name="file" content="9e819ce4-f4c1-488c-fee0-6f8b970a54f0" /><meta name="guid" content="9e819ce4-f4c1-488c-fee0-6f8b970a54f0" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">PeNet API Reference<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c3b4ace5-dd60-df04-b59a-7414bf1817b8.htm" title="PeNet API Reference" tocid="roottoc">PeNet API Reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c3b4ace5-dd60-df04-b59a-7414bf1817b8.htm" title="PeNet Library" tocid="c3b4ace5-dd60-df04-b59a-7414bf1817b8">PeNet Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="90b9b914-7758-24b5-25c5-e35fd8437218.htm" title="PeNet" tocid="90b9b914-7758-24b5-25c5-e35fd8437218">PeNet</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="5886c81e-a545-ed37-eb3d-af21b3e00b52.htm" title="PeFile Class" tocid="5886c81e-a545-ed37-eb3d-af21b3e00b52">PeFile Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2855361e-39aa-8e35-e0cf-a675ac59f647.htm" title="PeFile Methods" tocid="2855361e-39aa-8e35-e0cf-a675ac59f647">PeFile Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="45ad20c4-ab5f-3b99-20f7-efe61456a1d8.htm" title="GetCrlUrlList Method " tocid="45ad20c4-ab5f-3b99-20f7-efe61456a1d8">GetCrlUrlList Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="a50e8968-7be4-2a88-2a52-24ceb9f0937a.htm" title="GetFileType Method " tocid="a50e8968-7be4-2a88-2a52-24ceb9f0937a">GetFileType Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="9e819ce4-f4c1-488c-fee0-6f8b970a54f0.htm" title="GetImpHash Method " tocid="9e819ce4-f4c1-488c-fee0-6f8b970a54f0">GetImpHash Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="c9fffdf1-f808-bda1-1068-93b203b59de7.htm" title="GetUnwindInfo Method " tocid="c9fffdf1-f808-bda1-1068-93b203b59de7">GetUnwindInfo Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="a48ea7fc-aadc-4027-fd30-0536ec8c45fb.htm" title="IsValidPEFile Method " tocid="a48ea7fc-aadc-4027-fd30-0536ec8c45fb">IsValidPEFile Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn">PeFile<span id="LST2CB23E94_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST2CB23E94_0?cpp=::|nu=.");</script>GetImpHash Method </td></tr></table><span class="introStyle"></span><div class="summary">
                Mandiant’s imphash convention requires the following:
                Resolving ordinals to function names when they appear.
                Converting both DLL names and function names to all lowercase.
                Removing the file extensions from imported module names.
                Building and storing the lowercased strings in an ordered list.
                Generating the MD5 hash of the ordered list.
                oleaut32, ws2_32 and wsock32 can resolve ordinals to functions names.
                The implementation is equal to the python module "pefile" 1.2.10-139
                https://code.google.com/p/pefile/
            </div><p> </p><strong>Namespace:</strong> <a href="90b9b914-7758-24b5-25c5-e35fd8437218.htm">PeNet</a><br /><strong>Assembly:</strong> PeNet (in PeNet.dll) Version: 1.0.0.0 (1.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EDCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cs','1','4');return false;">C#</a></div><div id="ID0EDCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','vb','2','4');return false;">VB</a></div><div id="ID0EDCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cpp','3','4');return false;">C++</a></div><div id="ID0EDCA_tab4" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EDCA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EDCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EDCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">string</span> <span class="identifier">GetImpHash</span>()</pre></div><div id="ID0EDCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">GetImpHash</span> <span class="keyword">As</span> <span class="identifier">String</span></pre></div><div id="ID0EDCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">String</span>^ <span class="identifier">GetImpHash</span>()</pre></div><div id="ID0EDCA_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">GetImpHash</span> : <span class="keyword">unit</span> <span class="keyword">-&gt;</span> <span class="identifier">string</span> 
</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EDCA");</script><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a><br />The ImpHash of the PE file.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="5886c81e-a545-ed37-eb3d-af21b3e00b52.htm">PeFile Class</a></div><div class="seeAlsoStyle"><a href="90b9b914-7758-24b5-25c5-e35fd8437218.htm">PeNet Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">http://www.apache.org/licenses/LICENSE-2.0</a></p> </div></body></html>